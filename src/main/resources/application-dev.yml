# ==============================================================================
# КОНФИГУРАЦИЯ ДЛЯ ПРОФИЛЯ РАЗРАБОТКИ (DEV)
# Этот файл автоматически загружается когда spring.profiles.active=dev
# ==============================================================================

# Настройки сервера (можно переопределить порт)
server:
  # Порт для разработки (можно оставить 8080 из application.yml)
  # port: 8080

  # Настройки обработки ошибок для разработки
  error:
    # Включить полную информацию об ошибках (стек трейсы)
    include-stacktrace: always
    include-message: always
    include-binding-errors: always

# ==============================================================================
# НАСТРОЙКИ H2 БАЗЫ ДАННЫХ
# ==============================================================================
spring:
  # ------------------------------------------------------------------------------
  # DATASOURCE - Подключение к базе данных
  # ------------------------------------------------------------------------------
  datasource:
    # URL подключения к H2 базе в памяти
    # jdbc:h2:mem:testdb - создаёт базу "testdb" в оперативной памяти
    # При остановке приложения все данные удаляются
    url: jdbc:h2:mem:testdb

    # Драйвер H2 базы данных
    driver-class-name: org.h2.Driver

    # Имя пользователя для подключения к H2
    # "sa" - стандартный пользователь H2 (System Administrator)
    username: sa

    # Пароль для подключения
    # Оставляем пустым для H2 в режиме разработки
    password:

    # Настройки пула подключений HikariCP
    hikari:
      # Максимальное количество подключений в пуле
      # Для dev достаточно небольшого числа
      maximum-pool-size: 5

      # Минимальное количество подключений
      minimum-idle: 2

      # Имя пула (для логов)
      pool-name: H2-Dev-Pool

  # ------------------------------------------------------------------------------
  # H2 CONSOLE - Веб-интерфейс для просмотра базы данных
  # ------------------------------------------------------------------------------
  h2:
    console:
      # Включить H2 Console
      # Доступна по адресу: http://localhost:8080/h2-console
      enabled: true

      # Путь к консоли в браузере
      path: /h2-console

      # Настройки консоли
      settings:
        # Разрешить доступ с других компьютеров
        # false = только с localhost (безопаснее для dev)
        web-allow-others: false

        # Включить трейс (детальное логирование H2)
        trace: false

  # ------------------------------------------------------------------------------
  # JPA / HIBERNATE НАСТРОЙКИ ДЛЯ РАЗРАБОТКИ
  # ------------------------------------------------------------------------------
  jpa:
    # Показывать SQL запросы в консоли
    # true = все SQL запросы будут выводиться в лог
    show-sql: true

    # Настройки Hibernate
    hibernate:
      # Стратегия управления схемой базы данных
      # update = Hibernate автоматически обновит схему при изменении Entity
      # create-drop = Создаёт схему при старте, удаляет при остановке
      # Рекомендую: update (данные сохраняются между перезапусками)
      ddl-auto: update

    # Дополнительные properties Hibernate
    properties:
      hibernate:
        # Диалект для H2 (автоопределение)
        # Можно не указывать, Hibernate сам определит
        dialect: org.hibernate.dialect.H2Dialect

        # Показывать SQL в форматированном виде
        # Уже есть в application.yml, но можно переопределить
        format_sql: true

        # Показывать комментарии в SQL
        # Hibernate добавит комментарии, объясняющие какие Entity затронуты
        use_sql_comments: true

        # Включить статистику Hibernate
        # Показывает количество запросов, время выполнения и т.д.
        generate_statistics: false
  # ------------------------------------------------------------------------------
  # LIQUIBASE ДЛЯ РАЗРАБОТКИ
  # ------------------------------------------------------------------------------
  liquibase:
    # Включить Liquibase (уже в application.yml, но можно переопределить)
    enabled: true

    # Контексты для выполнения (можно фильтровать миграции)
    # Например: contexts: dev,test
    # Пустое значение = выполнять все миграции
    contexts: dev

    # Удалить существующие данные при старте (опционально)
    # false = сохранять данные между перезапусками
    # true = очищать базу при каждом запуске
    drop-first: false

# ==============================================================================
# ДЕТАЛЬНОЕ ЛОГИРОВАНИЕ ДЛЯ РАЗРАБОТКИ
# ==============================================================================
logging:
  level:
    # Корневой уровень логирования
    # INFO = показывать информационные сообщения и выше
    root: INFO

    # Логи для твоего приложения
    # DEBUG = показывать детальную отладочную информацию
    com.jabes.librebot: DEBUG

    # Логи Hibernate SQL
    # DEBUG = показывать все SQL запросы с деталями
    org.hibernate.SQL: DEBUG

    # Логи параметров SQL запросов
    # TRACE = показывать значения параметров в SQL (?, ?, ?)
    # Очень полезно для отладки!
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE

    # Логи результатов SQL запросов
    # TRACE = показывать результаты выполнения SQL
    org.hibernate.type.descriptor.sql.BasicExtractor: TRACE

    # Логи транзакций
    # DEBUG = показывать начало/конец транзакций
    org.hibernate.engine.transaction.internal.TransactionImpl: DEBUG

    # Логи Spring Framework (оставляем INFO)
    org.springframework: INFO

    # Логи Spring Boot (можно включить DEBUG для диагностики)
    org.springframework.boot: INFO

    # Логи Spring Web (HTTP запросы/ответы)
    # DEBUG = показывать детали HTTP запросов
    org.springframework.web: DEBUG

    # Логи HikariCP (пул подключений)
    # DEBUG = показывать информацию о пуле подключений
    com.zaxxer.hikari: INFO

    # Логи Liquibase
    # INFO = показывать применяемые миграции
    liquibase: INFO

    # Логи Telegram Bot API
    # DEBUG = показывать детали работы с Telegram API
    org.telegram.telegrambots: DEBUG

    org.springframework.web.reactive.function.client: TRACE
    reactor.netty.http.client: TRACE
    org.springframework.http.codec: TRACE

  # Паттерн вывода логов (можно переопределить из application.yml)
  pattern:
    # Добавляем цвета для консоли (работает в большинстве терминалов)
    console: "%clr(%d{yyyy-MM-dd HH:mm:ss}){faint} %clr([%level]){green} %clr([%thread]){magenta} %clr(%logger{36}){cyan} : %msg%n"

# ==============================================================================
# ДОПОЛНИТЕЛЬНЫЕ НАСТРОЙКИ ДЛЯ DEV
# ==============================================================================

# Настройки Actuator для разработки
management:
  endpoints:
    web:
      exposure:
        # Открыть все endpoints для разработки (удобно для отладки)
        # В production оставим только health,info
        include: "*"

  endpoint:
    health:
      # Всегда показывать детальную информацию о здоровье
      show-details: always



















